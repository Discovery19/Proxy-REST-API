# REST API с использованием Spring Boot
## Туториал по использованию моего "сервиса"

### Настройка
Перед запуском приложение нужно запустить команду:
```
docker compose up -d
```
Как видно по тексту используется Docker. Команда запустит compose файл, который скачает вам postgeSQL и произведет стартовые миграции в БД с помощью liquibase.

Если у вас почему-то нет Docker (скачайте!), вам необходимо руками создать postgreSQL с настройками, которые можно взять в application.yml.
А затем запустить SQL скрипт:
```
CREATE TABLE role (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255) UNIQUE
);
INSERT INTO role (id, name) VALUES (1, 'ADMIN'),(2, 'USER'),(3, 'ALBUM'),(4, 'POST');
```

**Настройка окончена!**
**Запустите приложение**

### Что можно увидеть используя браузер
Первое что вам потребуется это зарегистрироваться/авторизоваться, для этого перейдите по [local](http://localhost:8080/)http://localhost:8080/

Для User по умолчанию ставится роль "POST". Доступны лишь обработчики posts
Попробуйте перейти по данной ссылке:
http://localhost:8080/api/posts/1

Запросы кэшируются с помощью Spring cache (те даже если у вас выключат интернет странички на которых вы побывали загрузятся)) можете попробовать)

### Самое интересное, что же в БД
Вы можете изменить роль пользователя только вручную в БД. Для этого перейдите в таблицу users_roles и поменяйте role_id на необходимую вам (выбрать id для роли можно в таблице roles). 
Используя DBeaver будет выглядеть примерно так:
![image](https://github.com/Discovery19/Proxy-REST-API/assets/112725051/aa6c9634-511e-4c99-9790-555ae5ff9478)

Для использования других обработчиков используйте соответствующие роли или роль ADMIN:
- /api/posts/**
- /api/users/**
- /api/albums/**

Доступно множественное назначение ролей (чтобы использовалось сразу несколько обработчиков). Для этого добавьте в таблицу users_roles еще одну строку user_id - role_id
Пример для пользователя с id = 2 (ему теперь доступны обработчики ALBUM, POST):
![image](https://github.com/Discovery19/Proxy-REST-API/assets/112725051/d80e9c50-2ead-45e5-9231-6d3d2d1c2a36)

В БД также присутствует таблица с ведением аудита действий (audit_log):
![image](https://github.com/Discovery19/Proxy-REST-API/assets/112725051/2e5d5617-41e3-41d5-b545-458d53c477f0)

